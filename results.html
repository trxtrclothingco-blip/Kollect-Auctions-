<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Auction Results – Kollect</title>
<link rel="stylesheet" href="style.css">
<script type="module" src="firebase.js"></script>

<!-- ✅ DASHBOARD STYLE THEME -->
<script>
(function () {
  const isLight = localStorage.getItem("lightMode") === "true";

  if (isLight) {
    document.documentElement.classList.add("light-mode");
  }
})();
</script>

<style>
.ended-auction {
  background: #2a2a2a;
  border: 2px solid #2bb0ed; /* updated border to match live auctions */
  border-radius: 8px;
  padding: 12px;
  width: 300px; /* fixed width */
  height: 400px; /* fixed height */
  margin: 15px;
  display: inline-block;
  vertical-align: top;
  text-align: center;
  overflow: hidden; /* prevent overflow if text is long */
}

.ended-auction img {
  width: 100%;
  height: 220px;
  object-fit: cover;
  border-radius: 6px;
  margin-bottom: 10px;
}

.ended-auction h3,
.ended-auction p {
  margin: 5px 0;
  color: #ffffff; /* changed from gold to white */
}

.ended-auction .button {
  margin-top: 10px;
  padding: 8px 12px;
  background: #2a2a2a;
  color: #FFD700;
  border: 1px solid #FFD700;
  border-radius: 6px;
  cursor: pointer;
}

.kollect100-badge {
  display: inline-block;
  background: gold;
  color: black;
  font-weight: bold;
  padding: 2px 6px;
  margin-left: 6px;
  border-radius: 4px;
  font-size: 0.8rem;
}

#auction-pagination-controls {
  text-align: center;
  margin-top: 15px;
}

#auction-pagination-controls button {
  margin: 0 5px;
  padding: 8px 12px;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="burger" id="burgerMenu">
  <div></div><div></div><div></div>
</div>

<nav class="nav-menu" id="navMenu">
  <a href="index.html">Home</a>
  <a href="dashboard.html">Dashboard</a>
  <a href="about.html">About Us</a>
  <a href="live_auctions.html">Live Auctions</a>
  <a href="kollect_100.html">Watchlist ⭐️</a>
  <a href="private_sales.html">Private Sales</a>
  <a href="contact.html">Contact Us</a>
  <a href="results.html">Results</a>
  <a href="create_account.html">Sign In</a>
</nav>

<div id="user-status"></div>

<div class="container">
  <img src="IMG_1729.jpeg" alt="Kollect Auctions Logo" class="hero-image">
  <h1>Past Auction Results</h1>

  <div id="ended-auctions-list"></div>
  <div id="auction-pagination-controls"></div>

  <button class="button" onclick="window.location='index.html'">Back to Home</button>
</div>

<script type="module">
import { db } from './firebase.js';
import { collection, getDocs, query, where } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';

async function loadEndedAuctions() {
  const endedList = document.getElementById('ended-auctions-list');
  endedList.innerHTML = '';

  try {
    const endedQuery = query(collection(db, 'listings'), where('status', '==', 'ended'));
    const querySnapshot = await getDocs(endedQuery);

    if (querySnapshot.empty) {
      endedList.innerHTML = '<p>No ended auctions available.</p>';
      return;
    }

    querySnapshot.forEach((doc) => {
      const data = doc.data();
      const { name, price, image, description, kollect100 } = data;

      const card = document.createElement('div');
      card.classList.add('ended-auction');

      card.innerHTML = `
        <img src="${image}" alt="${name}">
        <h3>
          ${name}
          ${kollect100 ? '<span class="kollect100-badge">Kollect 100</span>' : ''}
        </h3>
        <p>${description || ''}</p>
        <p><strong>Final Price:</strong> £${price?.toLocaleString() || '0.00'}</p>
      `;

      endedList.appendChild(card);
    });
  } catch (error) {
    console.error('Error loading auctions:', error);
    endedList.innerHTML = '<p>Error loading auctions. Please try again later.</p>';
  }
}

document.addEventListener('DOMContentLoaded', loadEndedAuctions);
</script>

<script>
/* Burger Menu */
document.getElementById("burgerMenu")
  .addEventListener("click", () =>
    document.getElementById("navMenu").classList.toggle("open")
  );

/* ✅ DASHBOARD MATCHING TOGGLE */
const toggleBtn = document.getElementById("modeToggle");

toggleBtn.addEventListener("click", () => {
  const root = document.documentElement;
  root.classList.toggle("light-mode");
  const isLight = root.classList.contains("light-mode");
  localStorage.setItem("lightMode", isLight);
});
</script>

<script src="/js/notification.js"></script>
  
</body>
</html>
